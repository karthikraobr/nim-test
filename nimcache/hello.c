/* Generated by Nim Compiler v0.16.0 */
/*   (c) 2017 Andreas Rumpf */
/* The generated code is subject to the original license. */
/* Compiled for: Windows, amd64, gcc */
/* Command for C compiler:
   C:\MinGW\bin\gcc.exe -c  -w  -IC:\nim-0.16.0\lib -o c:\Projects\nim\HelloWorld\nimcache\hello.o c:\Projects\nim\HelloWorld\nimcache\hello.c */
#define NIM_INTBITS 64

#include "nimbase.h"
#include <string.h>
#include <stdio.h>
#undef linux
typedef struct TGenericSeq TGenericSeq;
typedef struct NimStringDesc NimStringDesc;
struct  TGenericSeq  {
NI len;
NI reserved;
};
struct  NimStringDesc  {
  TGenericSeq Sup;
NIM_CHAR data[SEQ_DECL_SIZE];
};
typedef N_STDCALL_PTR(unsigned int, TY_j77idhp9bgf22qb9czSP4rQw) (void);
N_NIMCALL(void*, nimLoadLibrary)(NimStringDesc* path0);
N_NOINLINE(void, nimLoadLibraryError)(NimStringDesc* path0);
N_NIMCALL(void*, nimGetProcAddr)(void* lib0, NCSTRING name0);
N_NIMCALL(NimStringDesc*, getlibname_9aalw9bqF4IfDZfCOTXksXFg)(NimStringDesc* libraryname0);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* src0);
static N_INLINE(void, appendString)(NimStringDesc* dest0, NimStringDesc* src0);
static N_INLINE(void, copymem_E1xtACub5WcDa3vbrIXbwgsystem)(void* dest0, void* source0, NI size0);
N_NIMCALL(NimStringDesc*, rawNewString)(NI space0);
static N_INLINE(void, nimFrame)(TFrame* s0);
N_NOINLINE(void, stackoverflow_II46IjNZztN9bmbxUD8dt8g)(void);
static N_INLINE(void, popFrame)(void);
N_NIMCALL(NimStringDesc*, HEX24_rzAI8EMyNBAQwGODeohhAA)(NU64 x0);
N_NIMCALL(void*, loadlib_EFK1MHQsQvQPg5NaJH389bA)(NimStringDesc* path0, NIM_BOOL globalsymbols0);
N_NIMCALL(void*, symaddr_fM7lTRTvv9a9axreJA2Bx7jA_2)(void* lib0, NCSTRING name0);
N_NIMCALL(NimStringDesc*, nimIntToStr)(NI x0);
static N_INLINE(void, initStackBottomWith)(void* locals0);
N_NOINLINE(void, setStackBottom)(void* thestackbottom0);
NIM_EXTERNC N_NOINLINE(void, systemInit000)(void);
NIM_EXTERNC N_NOINLINE(void, systemDatInit000)(void);
NIM_EXTERNC N_NOINLINE(void, stdlib_parseutilsInit000)(void);
NIM_EXTERNC N_NOINLINE(void, stdlib_parseutilsDatInit000)(void);
NIM_EXTERNC N_NOINLINE(void, stdlib_mathInit000)(void);
NIM_EXTERNC N_NOINLINE(void, stdlib_mathDatInit000)(void);
NIM_EXTERNC N_NOINLINE(void, stdlib_algorithmInit000)(void);
NIM_EXTERNC N_NOINLINE(void, stdlib_algorithmDatInit000)(void);
NIM_EXTERNC N_NOINLINE(void, stdlib_strutilsInit000)(void);
NIM_EXTERNC N_NOINLINE(void, stdlib_strutilsDatInit000)(void);
NIM_EXTERNC N_NOINLINE(void, stdlib_dynlibInit000)(void);
NIM_EXTERNC N_NOINLINE(void, stdlib_dynlibDatInit000)(void);
NIM_EXTERNC N_NOINLINE(void, NimMainModule)(void);
NIM_EXTERNC N_NOINLINE(void, helloDatInit000)(void);
static void* T_xLHv575t3PG1lB5wK05Xqg_2;
TY_j77idhp9bgf22qb9czSP4rQw Dl_115001;
extern TFrame* frameptr_HRfVMH3jYeBJz6Q6X9b6Ptw;
void* lib_UGTLeFG473NkTyjUIG8cig;
void* address_hJ9aoDyp4sfdp3w25wrAEdA;
STRING_LITERAL(T_xLHv575t3PG1lB5wK05Xqg_4, "factorial.dll", 13);
STRING_LITERAL(T_xLHv575t3PG1lB5wK05Xqg_5, "factorial.dll", 13);
STRING_LITERAL(T_xLHv575t3PG1lB5wK05Xqg_8, "", 0);
STRING_LITERAL(T_xLHv575t3PG1lB5wK05Xqg_9, ".dll", 4);
STRING_LITERAL(T_xLHv575t3PG1lB5wK05Xqg_10, "libfactorial", 12);
STRING_LITERAL(T_xLHv575t3PG1lB5wK05Xqg_11, "Lib Loaded", 10);
STRING_LITERAL(T_xLHv575t3PG1lB5wK05Xqg_12, "The address of sayHi is ", 24);

static N_INLINE(void, copymem_E1xtACub5WcDa3vbrIXbwgsystem)(void* dest0, void* source0, NI size0) {
	void* LOC1;
	LOC1 = (void*)0;
	LOC1 = memcpy(dest0, source0, ((size_t) (size0)));
}

static N_INLINE(void, appendString)(NimStringDesc* dest0, NimStringDesc* src0) {
	copymem_E1xtACub5WcDa3vbrIXbwgsystem(((void*) ((&(*dest0).data[((*dest0).Sup.len)- 0]))), ((void*) ((*src0).data)), ((NI) ((NI)((*src0).Sup.len + ((NI) 1)))));
	(*dest0).Sup.len += (*src0).Sup.len;
}

static N_INLINE(void, nimFrame)(TFrame* s0) {
	NI LOC1;
	LOC1 = (NI)0;
	{
		if (!(frameptr_HRfVMH3jYeBJz6Q6X9b6Ptw == NIM_NIL)) goto LA4;
		LOC1 = ((NI) 0);
	}
	goto LA2;
	LA4: ;
	{
		LOC1 = ((NI) ((NI16)((*frameptr_HRfVMH3jYeBJz6Q6X9b6Ptw).calldepth + ((NI16) 1))));
	}
	LA2: ;
	(*s0).calldepth = ((NI16) (LOC1));
	(*s0).prev = frameptr_HRfVMH3jYeBJz6Q6X9b6Ptw;
	frameptr_HRfVMH3jYeBJz6Q6X9b6Ptw = s0;
	{
		if (!((*s0).calldepth == ((NI16) 2000))) goto LA9;
		stackoverflow_II46IjNZztN9bmbxUD8dt8g();
	}
	LA9: ;
}

static N_INLINE(void, popFrame)(void) {
	frameptr_HRfVMH3jYeBJz6Q6X9b6Ptw = (*frameptr_HRfVMH3jYeBJz6Q6X9b6Ptw).prev;
}

N_NIMCALL(NimStringDesc*, getlibname_9aalw9bqF4IfDZfCOTXksXFg)(NimStringDesc* libraryname0) {
	NimStringDesc* result0;
	NimStringDesc* LOC1;
	nimfr("getLibName", "hello.nim")
{	result0 = (NimStringDesc*)0;
	nimln(8, "hello.nim");
	result0 = copyString(((NimStringDesc*) &T_xLHv575t3PG1lB5wK05Xqg_8));
	nimln(10, "hello.nim");
	LOC1 = (NimStringDesc*)0;
	LOC1 = rawNewString(libraryname0->Sup.len + 4);
appendString(LOC1, libraryname0);
appendString(LOC1, ((NimStringDesc*) &T_xLHv575t3PG1lB5wK05Xqg_9));
	result0 = LOC1;
	nimln(13, "hello.nim");
	goto BeforeRet;
	}BeforeRet: ;
	popFrame();
	return result0;
}

static N_INLINE(void, initStackBottomWith)(void* locals0) {
	setStackBottom(locals0);
}
void PreMainInner() {
	systemInit000();
	stdlib_parseutilsDatInit000();
	stdlib_mathDatInit000();
	stdlib_algorithmDatInit000();
	stdlib_strutilsDatInit000();
	stdlib_dynlibDatInit000();
	helloDatInit000();
	stdlib_parseutilsInit000();
	stdlib_mathInit000();
	stdlib_algorithmInit000();
	stdlib_strutilsInit000();
	stdlib_dynlibInit000();
}

void PreMain() {
	void (*volatile inner)();
	systemDatInit000();
	inner = PreMainInner;
	initStackBottomWith((void *)&inner);
	(*inner)();
}

int cmdCount;
char** cmdLine;
char** gEnv;
N_CDECL(void, NimMainInner)(void) {
	NimMainModule();
}

N_CDECL(void, NimMain)(void) {
	void (*volatile inner)();
	PreMain();
	inner = NimMainInner;
	initStackBottomWith((void *)&inner);
	(*inner)();
}

int main(int argc, char** args, char** env) {
	cmdLine = args;
	cmdCount = argc;
	gEnv = env;
	NimMain();
	return nim_program_result;
}

NIM_EXTERNC N_NOINLINE(void, NimMainModule)(void) {
	unsigned int LOC1;
	NimStringDesc* LOC2;
	NimStringDesc* LOC3;
	nimfr("hello", "hello.nim")
	nimln(16, "hello.nim");
	LOC1 = (unsigned int)0;
	LOC1 = Dl_115001();
	LOC2 = (NimStringDesc*)0;
	LOC2 = HEX24_rzAI8EMyNBAQwGODeohhAA(((NU64) (LOC1)));
	printf("%s\015\012", LOC2? (LOC2)->data:"nil");
	fflush(stdout);
	nimln(23, "hello.nim");
	LOC3 = (NimStringDesc*)0;
	LOC3 = getlibname_9aalw9bqF4IfDZfCOTXksXFg(((NimStringDesc*) &T_xLHv575t3PG1lB5wK05Xqg_10));
	lib_UGTLeFG473NkTyjUIG8cig = loadlib_EFK1MHQsQvQPg5NaJH389bA(LOC3, NIM_FALSE);
	nimln(25, "hello.nim");
	{
		NimStringDesc* LOC8;
		nimln(347, "system.nim");
		nimln(25, "hello.nim");
		if (!!((lib_UGTLeFG473NkTyjUIG8cig == NIM_NIL))) goto LA6;
		nimln(26, "hello.nim");
		printf("%s\015\012", ((NimStringDesc*) &T_xLHv575t3PG1lB5wK05Xqg_11)? (((NimStringDesc*) &T_xLHv575t3PG1lB5wK05Xqg_11))->data:"nil");
		fflush(stdout);
		nimln(27, "hello.nim");
		address_hJ9aoDyp4sfdp3w25wrAEdA = symaddr_fM7lTRTvv9a9axreJA2Bx7jA_2(lib_UGTLeFG473NkTyjUIG8cig, "factorial");
		nimln(28, "hello.nim");
		LOC8 = (NimStringDesc*)0;
		LOC8 = nimIntToStr(((NI) (address_hJ9aoDyp4sfdp3w25wrAEdA)));
		printf("%s%s\015\012", ((NimStringDesc*) &T_xLHv575t3PG1lB5wK05Xqg_12)? (((NimStringDesc*) &T_xLHv575t3PG1lB5wK05Xqg_12))->data:"nil", LOC8? (LOC8)->data:"nil");
		fflush(stdout);
	}
	LA6: ;
	popFrame();
}

NIM_EXTERNC N_NOINLINE(void, helloDatInit000)(void) {
if (!((T_xLHv575t3PG1lB5wK05Xqg_2 = nimLoadLibrary((NimStringDesc*) &T_xLHv575t3PG1lB5wK05Xqg_4))
)) nimLoadLibraryError((NimStringDesc*) &T_xLHv575t3PG1lB5wK05Xqg_5);
	Dl_115001 = (TY_j77idhp9bgf22qb9czSP4rQw) nimGetProcAddr(T_xLHv575t3PG1lB5wK05Xqg_2, "factorial");
}

